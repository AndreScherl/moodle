YUI.add("moodle-block_mbs_search-blocksearch",function(e,t){M.block_mbs_search=M.block_mbs_search||{},M.block_mbs_search.blocksearch={init:function(t){var n,r,i;n=e.one("#mbs_search_form #searchtext"),i=e.one("#mbs_search_form #search_schoolcatid"),n.plug(e.Plugin.AutoComplete,{resultFilters:null,resultHighligher:"phraseMatch",maxResults:2*(t.lookupcount+1),source:function(n,r){if(n.length<3)return;var s=0;i&&i.get("checked")&&(s=i.get("value")),e.io(t.url,{data:{action:"blockschoolsearch",searchtext:n,schoolcatid:s},on:{success:function(t,n){var i;try{i=e.JSON.parse(n.responseText)}catch(s){return}i.error!==0?alert(i.error):r(i.results)}}})},resultFormatter:function(t,n){return e.Array.map(n,function(e){return e.raw})}}),n.ac.on("select",function(e){var t;e.preventDefault();if(e.itemNode.get("tagname")==="a")return;t=e.itemNode.one("a"),window.location=t.get("href")}),i&&i.on("click",function(e){n.ac.sendRequest()}),r=n.next(".yui3-aclist"),r.appendTo("body")}}},"@VERSION@",{requires:["base","node","io-base","json","autocomplete","autocomplete-highlighters","autocomplete-filters","node-event-simulate"]});
