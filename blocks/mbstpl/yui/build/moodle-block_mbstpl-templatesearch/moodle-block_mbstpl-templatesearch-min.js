YUI.add("moodle-block_mbstpl-templatesearch",function(e,t){M.block_mbstpl=M.block_mbstpl||{},M.block_mbstpl.templatesearch={init:function(){var t=e.one("input#id_keyword"),n=function(t){var n=t.currentTarget.getDOMNode().value;n.length>=3?M.block_mbstpl.templatesearch.requestSuggestions(n):e.all(".mbstpl-suggestion").remove()};t.on("keyup",n),t.on("focus",n),t.on("blur",function(){setTimeout(function(){e.all(".mbstpl-suggestion").remove()},100)}),e.all(".mbstpl-list-controller img").on("click",function(t){t.preventDefault();var n=e.one('.mbstpl-search-form input[name="layout"]'),r=t.target.getAttribute("l");n.set("value",r);var i=e.all(".mbstpl-list-item");i.set("className"),i.addClass("mbstpl-list-item"),i.addClass("mbstpl-list-item-"+r)})},requestSuggestions:function(t){var n={method:"POST",sync:!1,timeout:5e3,data:{sesskey:M.cfg.sesskey,keyword:t},on:{success:M.block_mbstpl.templatesearch.renderAutocomplete}};e.io(M.cfg.wwwroot+"/blocks/mbstpl/autocomplete.php",n)},selectSuggestion:function(t){var n=t.currentTarget.getHTML();e.one("input#id_keyword").set("value",n),e.all(".mbstpl-suggestion").remove()},renderAutocomplete:function(t,n){e.all(".mbstpl-suggestion").remove();var r=JSON.parse(n.response),i=e.one("input#id_keyword"),s=i.getDOMNode().offsetWidth,o=i.getX();y=i.getY()+i.getDOMNode().offsetHeight;for(var u=0;u<r.length;u++){var a='<div class="mbstpl-suggestion" style=" top:'+y+"px; left:"+o+"px;width:"+s+'px">'+r[u]+"</div>",f=e.Node.create(a);f.on("click",M.block_mbstpl.templatesearch.selectSuggestion),e.one("body").append(f),y+=f.getDOMNode().offsetHeight}}}},"@VERSION@",{requires:["base","node"]});
