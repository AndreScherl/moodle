YUI.add("moodle-block_mbsnews-lookupset",function(e,t){M.block_mbsnews=M.block_mbsnews||{},M.block_mbsnews.lookupset={init:function(t){var n,r=e.one("#id_"+t.name),i=e.one("#id_"+t.name+"_search"),s=e.one("#id_"+t.name+"_list");i.plug(e.Plugin.AutoComplete,{resultFilters:null,resultHighligher:"phraseMatch",maxResults:t.lookupcount,source:function(n,r){var i=n.lastIndexOf("]");n=n.substr(i+1,n.length);if(n.length<3)return;var s={action:"search",searchtext:n};for(var o=0;o<t.ajaxparamnames.length;o++){var u=t.ajaxparamnames[o],a=e.one("#id_"+u);a&&(s[u]=a.get("value"))}e.io(t.url,{data:s,on:{success:function(t,n){var i;try{i=e.JSON.parse(n.responseText)}catch(s){return}i.error!==0?alert(i.error):r(i.results)}}})},resultFormatter:function(t,n){return e.Array.map(n,function(e){return e.raw})}}),i.ac.on("select",function(n){n.preventDefault();var o=n.itemNode.one("span"),u=o.get("id"),a=o.getContent(),f=a;f+="&nbsp;<span class='flookupset-delete'>",f+="<img src='"+M.util.image_url("t/delete")+"' alt = '"+M.str.moodle.delete+"' title='"+M.str.moodle.delete+"'/>",f+="</span>",f+="<input type='hidden' name='"+t.nameselected+"["+u+"]' value='"+a+"'/>",s.append(e.Node.create("<li>"+f+"</li>")),r.set("value","filled"),r.simulate("change"),i.ac.hide(),i.set("value","")}),s.delegate("click",function(e){e.currentTarget.ancestor().remove(!0),s.hasChildNodes()||r.set("value",""),r.simulate("change")},"span"),n=i.next(".yui3-aclist"),n.appendTo("body")}}},"@VERSION@",{requires:["base","node","io-base","json","autocomplete","autocomplete-highlighters","autocomplete-filters","node-event-simulate"]});
