YUI.add("moodle-block_mbstpl-templatesearch",function(e,t){M.block_mbstpl=M.block_mbstpl||{},M.block_mbstpl.templatesearch={init:function(){e.one("input#id_keyword").on("keyup",function(t){var n=t.currentTarget.getDOMNode().value;n.length>=3?M.block_mbstpl.templatesearch.requestSuggestions(n):e.all(".mbstpl-suggestion").remove()}),e.all("mbstpl-list-controller img").on("click",function(e){e.preventDefault()})},requestSuggestions:function(t){var n={method:"POST",sync:!1,timeout:5e3,data:{sesskey:M.cfg.sesskey,keyword:t},on:{success:M.block_mbstpl.templatesearch.renderAutocomplete}};e.io(M.cfg.wwwroot+"/blocks/mbstpl/autocomplete.php",n)},selectSuggestion:function(t){var n=t.currentTarget.getHTML();e.one("input#id_keyword").set("value",n),e.all(".mbstpl-suggestion").remove()},renderAutocomplete:function(t,n){e.all(".mbstpl-suggestion").remove();var r=JSON.parse(n.response),i=e.one("input#id_keyword"),s=i.getDOMNode().offsetWidth,o=i.getX();y=i.getY()+i.getDOMNode().offsetHeight;for(var u=0;u<r.length;u++){var a='<div class="mbstpl-suggestion" style=" top:'+y+"px; left:"+o+"px;width:"+s+'px">'+r[u]+"</div>",f=e.Node.create(a);f.on("click",M.block_mbstpl.templatesearch.selectSuggestion),e.one("body").append(f),y+=f.getDOMNode().offsetHeight}}}},"@VERSION@",{requires:["base","node"]});
