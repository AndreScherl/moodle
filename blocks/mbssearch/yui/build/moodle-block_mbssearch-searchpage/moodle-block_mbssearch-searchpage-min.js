YUI.add("moodle-block_mbssearch-searchpage",function(e,t){M.block_mbssearch=M.block_mbssearch||{},M.block_mbssearch.initsearchpage=function(t){function s(){var s={};s.action="loadmoreresults",s.searchtext=e.one("#mbssearchpage_form #searchtext").get("value"),s.limitfrom=n,s.limitnum=r,s.filterby=e.one("#mbssearchpage_form #menufilterby").get("value");var u=M.util.add_spinner(e,i);e.io(t.url,{data:s,on:{start:function(){u.show()},success:function(t,n){var r;try{r=e.JSON.parse(n.responseText)}catch(i){return}u.hide(),r.error!==0?alert(r.error):o(r.results)},failure:function(){u.hide()}}})}function o(t){t.limitfrom+t.limitnum>=t.total&&e.one("#loadmoreresults").hide(),e.one("#mbssearch_resultlist").append(t.html),n+=r}function u(){n=Number(t.limitfrom),r=Number(t.limitnum),i=e.one("#loadmoreresults"),e.one("#mbssearchpage_form #menufilterby").on("change",function(t){e.one("#mbssearchpage_form").submit()}),i&&i.set("href","#"),e.one("#mbssearch_result").delegate("click",function(e){e.preventDefault(),s()},"#loadmoreresults")}var n,r,i;u()}},"@VERSION@");
