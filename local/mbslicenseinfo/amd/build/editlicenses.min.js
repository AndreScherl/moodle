define(["jquery","core/str"],function(a){function b(b){var c=a(b).find(".mbslicenseinfo-preview-content");if(c){var d=new M.core.dialogue({draggable:!0,bodyContent:c.html(),headerContent:"Preview",centered:!0,modal:!0,visible:!0,closeButton:!0,zIndex:100});d.render(),d.show()}}function c(b){var c=a(b).attr("id").split("_")[1],d=a("#id_"+c),e=["title","author","filesource"];if(d){a.each(e,function(b,c){var e=d.find('input[name^="'+c+'"]'),f=a(e).first().prop("value");f&&a(e).each(function(){a(this).attr("value",f)})});var f=d.find('select[name^="licenseshortname"]'),g=a(f).first().val(),h=a(f).first().siblings('input[name^="licensefullname"]').val(),i=a(f).first().siblings('input[name^="licensesource"]').val();g&&a(f).each(function(){a(this).val(g);var b=a(this).siblings('input[name^="licensefullname"]'),c=a(this).siblings('input[name^="licensesource"]');"__createnewlicense__"===g?(b.show(),b.val(h),c.show(),c.val(i)):(b.hide(),c.hide())})}}return{init:function(){a("div.editlicenses .mbslicenseinfo-previewicon").on("click",function(a){a.stopPropagation(),b(this)}),a(".mbslicenseinfo-transferbutton").on("click",function(){c(this)})}}});